var valid,voted,article_uid
function sendVote(e){url=`/rating/${article_uid}/${e}/`,fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-cache",redirect:"follow",referrerPolicy:"no-referrer"}).then(e=>e.json()).then(e=>{console.log(e)}).catch(e=>{console.log("Voting error: ",e)})}function rate(){checkCookie(),canVote&&(document.getElementById("btn_like").onclick=function(){voted||(sendVote(1),voted=!0,increase_vote("vote_like"),setCookie(),addMessage())},document.getElementById("btn_unlike").onclick=function(){voted||addUnlikeForm()})}function addMessage(){document.getElementById("message").innerHTML="<div>Dziękujemy za ocenę</div>"}function addMessageUnlike(){document.getElementById("message").innerHTML="<div>Dziękujemy za przesłanie opinii</div>"}function addUnlikeForm(){document.getElementById("rating__vote").classList.add("rating__display"),document.getElementById("rating__form").classList.add("rating__display"),document.getElementById("btnsendcomment").onclick=function(){pushCommentForGTM()},document.getElementById("btncancel").onclick=function(){removeUnlikeForm()}}function removeUnlikeForm(){document.getElementById("rating__vote").classList.remove("rating__display"),document.getElementById("rating__form").classList.remove("rating__display")}function addThanks(){document.getElementsByClassName("rating__question")[0].children[0].innerText="Dziękujemy za oddanie głosu."}function increase_vote(e){vote_div=document.getElementById(e),vote_number=parseInt(vote_div.innerText),vote_div.innerHTML=vote_number+1}function checkCookie(){canVote=!(0<=document.cookie.indexOf("voted_"+article_uid+"="))}function setCookie(){var e=new Date
e.setTime(e.getTime()+864e7),e="expires="+e.toGMTString(),document.cookie="voted_"+article_uid+"=yes;"+e}function pushCommentForGTM(){var e=document.getElementById("rating_textarea")
e.validity.valid?(dataLayer.push({event:"rating__form",rating__form_comment:e.value}),sendVote(0),voted=!0,increase_vote("vote_unlike"),setCookie(),addMessageUnlike(),removeUnlikeForm()):valid&&validateForm()}function validateForm(){var e=document.createElement("A"),t=document.createTextNode("Komentarz musi zawierać co najmniej 5 znaków")
e.appendChild(t),e.setAttribute("style","color:red; font-size: 14px;"),(t=document.getElementById("rating__form").childNodes[1]).insertBefore(e,t.children[t.children.length-2]),valid=!1}window.dataLayer=window.dataLayer||[],voted=!(valid=!0),article_uid=document.getElementById("rating__vote").dataset.articleUid,rate()
