class ViewSourceManager{constructor(){this.referrerUrl=document.referrer,this.currentDomain=window.location.hostname,this.pageUrl=window.location.href,this.sourceCookieName="pageViewSource"}setCookie(){var e=this.getSourceCookie(),r=this.getMainDomainName()
this.sourceCookieExist(e)?this.updateCookie(e,r):(e=this.getSource(),this.createCookie(e,r))}getMainDomainName(){return this.currentDomain.substring(this.currentDomain.lastIndexOf(".",this.currentDomain.lastIndexOf(".")-1)+1)}getSourceCookie(){let o={}
return document.cookie.split(";").forEach(function(e){var[e,r]=e.split("=")
o[e.trim()]=r}),o[this.sourceCookieName]}sourceCookieExist(e){return void 0!==e}updateCookie(e,r){var o=e.match(/\d+/),i=9<parseInt(o[0])?10:parseInt(o[0])+1,e=(console.log("lastCount: "+o+"; currentCount: "+i),e.replace(o,i))
document.cookie=this.sourceCookieName+`=${e};domain=${r};path=/`}getSource(){return this.pageUrl.includes("utm_medium=push")?"push":this.pageUrl.includes("utm_source=facebook")||this.pageUrl.includes("utm_medium=paidsocial")?"paid_facebook":this.isDirect()?"direct":this.referrerUrl.includes("quicksearchbox")||this.referrerUrl.includes("googleapis")?"google_discover":this.referrerUrl.includes("www.google.")?"google_search":this.referrerUrl.includes(".facebook.com")?"facebook":"other"}isDirect(){return this.pageUrl===`https://www.${this.currentDomain}/`&&this.referrerUrl.includes("//www.google")||""===this.referrerUrl}createCookie(e,r){document.cookie=this.sourceCookieName+`=${e}_1;domain=${r};path=/`}}const viewSourceManagerInstance=new ViewSourceManager
viewSourceManagerInstance.setCookie()
